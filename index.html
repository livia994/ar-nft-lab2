<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AR NFT Project (Debug Mode)</title>

    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/3.4.7/aframe/build/aframe-ar-nft.js"></script>

    <style>
      body { margin: 0; overflow: hidden; }
      #arjsDebugUIContainer { position: absolute !important; z-index: 999; }
    </style>
  </head>

  <body>
    <a-scene
      vr-mode-ui="enabled: false"
      renderer="logarithmicDepthBuffer: true;"
      embedded
      arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: true;"
    >
      <a-nft
        type="nft"
        url="./13"
        smooth="true"
        smoothCount="10"
        smoothTolerance="0.01"
        smoothThreshold="5"
        emitevents="true"
        id="marker"
      >

        <!-- Debug: adds a visible axis at the marker origin -->
        <a-entity id="axisHelper" position="0 0 0" visible="true">
          <a-entity line="start: 0 0 0; end: 1 0 0; color: red"></a-entity>
          <a-entity line="start: 0 0 0; end: 0 1 0; color: green"></a-entity>
          <a-entity line="start: 0 0 0; end: 0 0 1; color: blue"></a-entity>
        </a-entity>

        <!-- Scenario 1: Rotating Pyramid -->
        <a-entity id="obj1" position="0 0.5 0" visible="true">
          <a-cone
            height="0.8"
            radius-bottom="0.6"
            color="#FFD700"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 4000; easing: linear"
            animation__float="property: position; dir: alternate; dur: 1500; loop: true; 
                              to: 0 0.7 0; from: 0 0.5 0"
          ></a-cone>
        </a-entity>

        <!-- Scenario 2: Color-changing Sphere -->
        <a-entity id="obj2" position="0 0.5 0" visible="false">
          <a-sphere
            radius="0.45"
            animation="property: color; from: #3366FF; to: #FF33AA; loop: true; dur: 2000"
            animation__pulse="property: scale; dir: alternate; dur: 1500; loop: true;
                              to: 1.4 1.4 1.4; from: 1 1 1"
          ></a-sphere>
        </a-entity>

        <!-- Scenario 3: Portal Ring + Text -->
        <a-entity id="panel" position="0 0.5 0" visible="false">
          <a-torus
            radius="0.8"
            radius-tubular="0.05"
            color="#00FFFF"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 3000"
            animation__pulse="property: scale; dir: alternate; dur: 1500; loop: true;
                              to: 1.2 1.2 1.2; from: 1 1 1"
          ></a-torus>

          <a-text
            value="You opened the portal!"
            color="#FFFFFF"
            align="center"
            width="2"
            position="0 -0.2 0.2"
          ></a-text>
        </a-entity>

      </a-nft>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      let state = 0;
      const obj1 = document.querySelector("#obj1");
      const obj2 = document.querySelector("#obj2");
      const panel = document.querySelector("#panel");

      // logs when marker is found/lost
      const marker = document.querySelector("#marker");
      marker.addEventListener("markerFound", () => console.log("ðŸ“Œ MARKER FOUND"));
      marker.addEventListener("markerLost", () => console.log("âŒ MARKER LOST"));

      document.body.addEventListener("click", () => {
        if (state === 0) {
          console.log("âž¡ SWITCH: Pyramid â†’ Sphere");
          obj1.setAttribute("visible", "false");
          obj2.setAttribute("visible", "true");
          state = 1;
        } else if (state === 1) {
          console.log("âž¡ SWITCH: Sphere â†’ Portal");
          obj2.setAttribute("visible", "false");
          panel.setAttribute("visible", "true");
          state = 2;
        }
      });
    </script>
  </body>
</html>
